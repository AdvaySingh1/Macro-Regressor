<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=b7c8797371a4b8718f8f0245bbbcd2754a9d999e" media="screen" type="text/css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print" type="text/css">

    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Macro-Regressor</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Macro-Regressor" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/" />
<meta property="og:url" content="http://localhost:4000/" />
<meta property="og:site_name" content="Macro-Regressor" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Macro-Regressor" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","headline":"Macro-Regressor","name":"Macro-Regressor","url":"http://localhost:4000/"}</script>
<!-- End Jekyll SEO tag -->


    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>

  <body>
    <header>
      <div class="inner">
        <a href="http://localhost:4000/">
          <h1>Macro-Regressor</h1>
        </a>
        <h2></h2>
        
          <a href="https://github.com/AdvaySingh1/Macro-Regressor" class="button"><small>View project on</small> GitHub</a>
        
        
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<h1 id="macro-regressor">Macro-Regressor</h1>

<h2 id="introduction">Introduction</h2>
<p>The Macro-Regressor is a Data Sience project conducting exploratory and predictive analysis on two datasets from <a href="https://www.food.com/">Food.com</a>. The Datasets consist of reciples, each uniquely indentified by their Reciple ID. Hence, the Recipes were merged on the recipe id to form the <strong>Recipe Dataframe</strong> we will be exploring.</p>
<h4 id="recipe-dataframe">Recipe Dataframe</h4>
<p>The Recipe Dataframe originally consists of 234429 rows and 15 columns.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Column</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">name</code></td>
      <td style="text-align: left">The name of the recipe.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">id</code></td>
      <td style="text-align: left">A unique identifier for the recipe.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">minutes</code></td>
      <td style="text-align: left">The total time required to prepare the recipe.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">contributor_id</code></td>
      <td style="text-align: left">The ID of the user who submitted the recipe.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">submitted</code></td>
      <td style="text-align: left">The date when the recipe was submitted.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">tags</code></td>
      <td style="text-align: left">List of associated tags describing the recipe.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">nutrition</code></td>
      <td style="text-align: left">Nutritional information for the recipe. This is list which contains [calories (#), total fat (PDV), sugar (PDV), sodium (PDV), protein (PDV), saturated fat (PDV), carbohydrates (PDV)] where PDV is the % daily value.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">n_steps</code></td>
      <td style="text-align: left">The number of steps in the recipe.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">steps</code></td>
      <td style="text-align: left">Instructions detailing the steps to prepare the recipe.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">description</code></td>
      <td style="text-align: left">A brief overview or description of the recipe.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">ingredients</code></td>
      <td style="text-align: left">List of ingredients required for the recipe.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">n_ingredients</code></td>
      <td style="text-align: left">The number of ingredients in the recipe.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">user_id</code></td>
      <td style="text-align: left">The ID of the user interacting with the recipe.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">date</code></td>
      <td style="text-align: left">The date related to a specific event or interaction.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">rating</code></td>
      <td style="text-align: left">The user rating for the recipe.</td>
    </tr>
  </tbody>
</table>

<p>This dataframe provides several insights on a topic which unites us all: food! Lot’s can be drawn from the Dataframe, however, there’s a pressing matter at hand; according to <a href="https://www.cbsnews.com/news/obesity-rate-us-adults-cdc-data-map/#:~:text=Now%20the%20CDC%20estimates%20that,virtually%20every%20year%20since%202011.">CBS news</a>, obesity rates in the U.S. exceed <strong>40%</strong> as of 2024. Hence, understanding our food’s nutritional value is key to building a healthier nation. The focus of this project will be on nutrition.</p>

<h2 id="data-cleaning-and-exploratory-data-analysis">Data Cleaning and Exploratory Data Analysis</h2>
<p>The following steps were taken to clean the Dataframe: <br /></p>

<p>1) Transforming each of the nutritional columns into appropriate <strong>Macros</strong>. I.e, <code class="language-plaintext highlighter-rouge">fat</code>, <code class="language-plaintext highlighter-rouge">sugar</code>, <code class="language-plaintext highlighter-rouge">sodium</code>, <code class="language-plaintext highlighter-rouge">protein</code>, <code class="language-plaintext highlighter-rouge">saturated fat</code>, <code class="language-plaintext highlighter-rouge">carbohydrates</code> in grams rather than PDV. This is because the reccomended PDV differs from person to person. To do this, the Food.com uses the following PDVs as reccomended by the FDA:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Macro</th>
      <th style="text-align: right">PDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">fat</td>
      <td style="text-align: right">78</td>
    </tr>
    <tr>
      <td style="text-align: left">sugar</td>
      <td style="text-align: right">50</td>
    </tr>
    <tr>
      <td style="text-align: left">sodium</td>
      <td style="text-align: right">2300</td>
    </tr>
    <tr>
      <td style="text-align: left">protein</td>
      <td style="text-align: right">50</td>
    </tr>
    <tr>
      <td style="text-align: left">saturated fat</td>
      <td style="text-align: right">20</td>
    </tr>
    <tr>
      <td style="text-align: left">carbohydrates</td>
      <td style="text-align: right">275</td>
    </tr>
  </tbody>
</table>

<p>2) The <code class="language-plaintext highlighter-rouge">calories</code> column was often times severely inaccurate. The following formula was used to recalculate the calories columns
<br />\(\hspace{15em}\text{calories} = \text{fat} \cdot 9 +\text{protein} \cdot 4 + \text{carbohydrates} \cdot 4\)<br /> where the units for all of the macros are grams.</p>

<p>3) The <code class="language-plaintext highlighter-rouge">ingredeints</code> and <code class="language-plaintext highlighter-rouge">tags</code> columns were transformed into lists rather than strings of the list. <br /></p>

<p>4) Finally, no imputation was needed. None of the aforementioned columns had <code class="language-plaintext highlighter-rouge">NaN</code> or missing values.  <br /></p>

<p>Here’s a sample of the resulting Dataframe</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">name</th>
      <th style="text-align: left">calories</th>
      <th style="text-align: left">sugar</th>
      <th style="text-align: right">sodium</th>
      <th style="text-align: right">protein</th>
      <th style="text-align: right">carbohydrates</th>
      <th style="text-align: right">fat</th>
      <th style="text-align: right">saturated fat</th>
      <th style="text-align: right">n_ingredients</th>
      <th style="text-align: right">n_steps</th>
      <th style="text-align: right">ingredients</th>
      <th style="text-align: right">tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">dirty sriracha bloody mary</td>
      <td style="text-align: left">24</td>
      <td style="text-align: left">9</td>
      <td style="text-align: right">299</td>
      <td style="text-align: right">0.5</td>
      <td style="text-align: right">5.5</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">8</td>
      <td style="text-align: right">5</td>
      <td style="text-align: right">[‘celery salt’, ‘fresh lemon juice’, ‘horseradish’, ‘olive juice’, ‘sriracha sauce’, ‘tomato juice’, ‘vodka’, ‘worcestershire sauce’]</td>
      <td style="text-align: right">[‘15-minutes-or-less’, ‘3-steps-or-less’, ‘beverages’, ‘cocktails’, ‘course’, ‘easy’, ‘for-1-or-2’, ‘main-ingredient’, ‘number-of-servings’, ‘preparation’, ‘time-to-make’, ‘tomatoes’, ‘vegetables’]</td>
    </tr>
    <tr>
      <td style="text-align: left">rolachi</td>
      <td style="text-align: left">451.74</td>
      <td style="text-align: left">31</td>
      <td style="text-align: right">828</td>
      <td style="text-align: right">26</td>
      <td style="text-align: right">22</td>
      <td style="text-align: right">28.86</td>
      <td style="text-align: right">7.6</td>
      <td style="text-align: right">8</td>
      <td style="text-align: right">10</td>
      <td style="text-align: right">[‘green peppers’, ‘ground beef’, ‘onion’, ‘pepper’, ‘salad oil’, ‘salt’, ‘stewed tomatoes’, ‘zucchini’]</td>
      <td style="text-align: right">[‘3-steps-or-less’, ‘30-minutes-or-less’, ‘beef’, ‘easy’, ‘ground-beef’, ‘main-ingredient’, ‘meat’, ‘preparation’, ‘time-to-make’]</td>
    </tr>
    <tr>
      <td style="text-align: left">peanut butter truffle cupcakes</td>
      <td style="text-align: left">5060.14</td>
      <td style="text-align: left">538.5</td>
      <td style="text-align: right">2898</td>
      <td style="text-align: right">89</td>
      <td style="text-align: right">374</td>
      <td style="text-align: right">356.46</td>
      <td style="text-align: right">157.8</td>
      <td style="text-align: right">14</td>
      <td style="text-align: right">20</td>
      <td style="text-align: right">[‘baking cocoa’, ‘baking soda’, ‘brewed coffee’, ‘butter’, ‘buttermilk’, ‘creamy peanut butter’, ‘eggs’, ‘flour’, ‘heavy whipping cream’, ‘salt’, ‘semisweet chocolate’, ‘sugar’, ‘vanilla’, ‘white baking chocolate’]</td>
      <td style="text-align: right">[‘60-minutes-or-less’, ‘baking’, ‘cake-fillings-and-frostings’, ‘cakes’, ‘course’, ‘cupcakes’, ‘desserts’, ‘equipment’, ‘oven’, ‘preparation’, ‘time-to-make’]</td>
    </tr>
  </tbody>
</table>

<p><strong>Note</strong> While there were more columns (<code class="language-plaintext highlighter-rouge">reviews</code>, <code class="language-plaintext highlighter-rouge">descriptions</code>, etc.), these were not used for the rest of the analysis and were disgarded.</p>

<h3 id="univariate-analysis">Univariate Analysis</h3>
<p>Now let’s look at the distributions of some of the plots.</p>

<p><strong>Note</strong> There were <code class="language-plaintext highlighter-rouge">2000</code> bins used for the following macro distributions in order to be able to view the distributions. <br />
Here’s the distribution of the calories. It’s got a unique distribution but is still monotone decreasing for the most part. Dwelling deeper into it’s compoenents (see formula above) leads to a more firm understanding of this distribution.</p>
<iframe src="assets/dist-calories.html" width="800" height="600" frameborder="0"></iframe>
<p>Looking at the distribution of protein, we see a distribution which almost resembels a exponential distribution, just with a discerete variable. But then why doesn’t the calorie distribution also resemble this shape?</p>
<iframe src="assets/dist-protein.html" width="800" height="600" frameborder="0"></iframe>
<p>The distribution of the fat macro in grams play a big part. As seen above, it’s more common for recipes to have more fat. Additionally, this isn’t monotone decreasing and certain amounts of fat seem to be more common than others.</p>
<iframe src="assets/dist-fat.html" width="800" height="600" frameborder="0"></iframe>

<p>The distribution of the other numerical columns resembeled a normal distribution. Interestingly enough, while the variance in the number of steps is slightly greater, they both share the same mean.
Here’s the distribution of the number of ingredients.</p>
<iframe src="assets/dist-n_ing.html" width="800" height="600" frameborder="0"></iframe>

<p>Here’s the distribution of the number of steps.</p>
<iframe src="assets/dist-n_steps.html" width="800" height="600" frameborder="0"></iframe>

<h3 id="bivariate-analysis">Bivariate Analysis</h3>
<p>Now it’s time to see how some of these features may be correlated. <br />
Perhaps the most obvious correlations which come to mind are those related to specific macros and calories. As you observe the following correlations, you’re encouraged to view the \(R^2\) and \(R\) score to get an idea of which macros are most closely tied to the overall calories.</p>
<iframe src="assets/bi-calories-carbohydrates.html" width="800" height="600" frameborder="0"></iframe>
<iframe src="assets/bi-calories-fat.html" width="800" height="600" frameborder="0"></iframe>
<iframe src="assets/bi-calories-protein.html" width="800" height="600" frameborder="0"></iframe>
<p>The trends for sugar, sodium, and saturated fats, were simlar. All of them had a strong, positive, linear relationship with the calories macro with few outliers.</p>

<p>Interestingly, as the number of ingredients increase, the amount of time taken to make the recipes in minutes tends to decrease, though the correlation is not very strong. This may not be as nutritionally relavant, but is interesting nonetheless. As expected, however, we see the opposite trend in minutes vs the number of steps as the recipes requiring more steps tend to take longer as well.</p>
<iframe src="assets/bi-min-n_ing.html" width="800" height="600" frameborder="0"></iframe>

<h3 id="interesting-aggregates">Interesting Aggregates</h3>
<p>To undestand the relavance of the aggregates, you must be familiarized about details of the <code class="language-plaintext highlighter-rouge">ingredients</code> and <code class="language-plaintext highlighter-rouge">tag</code>features of the recipe dataframe.</p>

<p>Here’s a few of the most popular tags and the proportion of recipes which had them.</p>
<iframe src="assets/popular-ings.html" width="800" height="600" frameborder="0"></iframe>

<p>Similarly, here’s some of the popular tags!</p>

<iframe src="assets/popular-tags.html" width="800" height="600" frameborder="0"></iframe>

<p>Feel free to refer to these as you go through the rest of the analysis and creating the model. These provides key insights on nutrition.</p>

<h4 id="recipe-composition-and-ingredients">Recipe Composition and Ingredients</h4>
<p>Here’s the recipe composision of recipes with and without the <code class="language-plaintext highlighter-rouge">butter</code> ingredient. Observe how the macros are impacted.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">Butter Ingredient</th>
      <th style="text-align: right">calories</th>
      <th style="text-align: right">carbohydrates</th>
      <th style="text-align: right">protein</th>
      <th style="text-align: right">fat</th>
      <th style="text-align: right">sugar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">False</td>
      <td style="text-align: right">41.7</td>
      <td style="text-align: right">22</td>
      <td style="text-align: right">10</td>
      <td style="text-align: right">13.26</td>
      <td style="text-align: right">10</td>
    </tr>
    <tr>
      <td style="text-align: right">True</td>
      <td style="text-align: right">49.1</td>
      <td style="text-align: right">27.5</td>
      <td style="text-align: right">7.5</td>
      <td style="text-align: right">19.5</td>
      <td style="text-align: right">13.5</td>
    </tr>
  </tbody>
</table>

<p>More, interestingly, let’s visualize this:</p>
<iframe src="assets/macro-compo-butter-ing.html" width="800" height="600" frameborder="0"></iframe>

<p>Here’s the impact of adding <code class="language-plaintext highlighter-rouge">eggs</code> to the recipes.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">Eggs Ingredient</th>
      <th style="text-align: right">calories</th>
      <th style="text-align: right">carbohydrates</th>
      <th style="text-align: right">protein</th>
      <th style="text-align: right">fat</th>
      <th style="text-align: right">sugar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">False</td>
      <td style="text-align: right">42.9</td>
      <td style="text-align: right">22</td>
      <td style="text-align: right">9</td>
      <td style="text-align: right">14.82</td>
      <td style="text-align: right">10.5</td>
    </tr>
    <tr>
      <td style="text-align: right">True</td>
      <td style="text-align: right">49.1</td>
      <td style="text-align: right">27.5</td>
      <td style="text-align: right">8.5</td>
      <td style="text-align: right">19.5</td>
      <td style="text-align: right">20.5</td>
    </tr>
  </tbody>
</table>

<iframe src="assets/macro-compo-eggs-ing.html" width="800" height="600" frameborder="0"></iframe>

<h4 id="recipe-composition-and-tags">Recipe Composition and Tags</h4>
<p>A similar trend can be ovserved with tags.
Here’s the recipes with the <code class="language-plaintext highlighter-rouge">meat</code> tag.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">Meat Tag</th>
      <th style="text-align: right">calories</th>
      <th style="text-align: right">carbohydrates</th>
      <th style="text-align: right">protein</th>
      <th style="text-align: right">fat</th>
      <th style="text-align: right">sugar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">False</td>
      <td style="text-align: right">41.4</td>
      <td style="text-align: right">24.75</td>
      <td style="text-align: right">6</td>
      <td style="text-align: right">12.48</td>
      <td style="text-align: right">12</td>
    </tr>
    <tr>
      <td style="text-align: right">True</td>
      <td style="text-align: right">53</td>
      <td style="text-align: right">19.25</td>
      <td style="text-align: right">29</td>
      <td style="text-align: right">25.74</td>
      <td style="text-align: right">8.5</td>
    </tr>
  </tbody>
</table>

<iframe src="assets/macro-compo-meat-tag.html" width="800" height="600" frameborder="0"></iframe>

<p>Adding an opposite effect, here’s the recipes with and without the <code class="language-plaintext highlighter-rouge">vegetable</code> tag.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">Vegtable Tag</th>
      <th style="text-align: right">calories</th>
      <th style="text-align: right">carbohydrates</th>
      <th style="text-align: right">protein</th>
      <th style="text-align: right">fat</th>
      <th style="text-align: right">sugar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">False</td>
      <td style="text-align: right">44.7</td>
      <td style="text-align: right">24.75</td>
      <td style="text-align: right">9.5</td>
      <td style="text-align: right">15.6</td>
      <td style="text-align: right">12.5</td>
    </tr>
    <tr>
      <td style="text-align: right">True</td>
      <td style="text-align: right">41.4</td>
      <td style="text-align: right">19.25</td>
      <td style="text-align: right">8</td>
      <td style="text-align: right">14.04</td>
      <td style="text-align: right">9</td>
    </tr>
  </tbody>
</table>

<iframe src="assets/macro-compo-veg-tag.html" width="800" height="600" frameborder="0"></iframe>

<h2 id="framing-a-prediction-problem">Framing a Prediction Problem</h2>
<p>These recipes seem to provide in depth nutritional explanations. However, what if this weren’t the case. <br />
One may one want to know the nutritional information of their recipes, but not have adequete information (calories, protein, fat, arbohydrates, sodium, sugar, and saturated fat). In a realistic setting, we’d only know a few things: how  long the recipe takes, the # of ingredeints associated with the recipe, what the ingredeints are, and finally any tags you would associate with the recipe (the vibe of the recipe, if you will).</p>

<p>Hence, we will greate a <strong>Regressor</strong> for each of the aforementioned macros. <br />
Here’s a few specifications on the regressor in addition to why we choose them. <br /></p>
<ul>
  <li>We will use a <strong>Linear Regression</strong> model for the regressor. Due to it’s parametric nature, we will later be able to interprate the importance of certain features in the model. This can also provide key insights on certain ingredeints, tags, and trends based on the # of steps etc.</li>
  <li>We will <strong>Regularize</strong> the model. In this way, we will be using <strong>Lasso Regression</strong>  for the model. The reason for Lasso is, again, intepretability. Lasso, standing for <em>Least Absolute Shrinkage and Selection</em> means that our trained model will only contain the parameters which actually impact our predictions.</li>
  <li>Lastly, since we are predicting each macro, we will be creating a class whoose API consists of being able to select which Macro you’d like to see predicted.</li>
</ul>

<h2 id="baseline-model">Baseline Model</h2>
<p>In the baseline model, we will test this theory. It will be a more simple model. One aimed a solely predicting protein based on the presense of the meat tag, number of steps, number of <code class="language-plaintext highlighter-rouge">ingredeints</code>, and <code class="language-plaintext highlighter-rouge">eggs</code> (nominal and the only categorical). Later, we will add additional features and transform the numerical features to better match the models.
The model achieved the following accuracies:</p>

<table>
  <tbody>
    <tr>
      <td>Train MSE</td>
      <td>441.738</td>
    </tr>
    <tr>
      <td>Test MSE</td>
      <td>604.551</td>
    </tr>
  </tbody>
</table>

<p>While this model did attain a decently low MSE, there’s a few problems with the model. Firstly, it’s only trained for protein. Encoding the ingredients must be done one at a time. In this case, the eggs ingredient was binary encoded, I.e., each recipe either contained eggs somewhere along it’s recipe list or didn’t. This ingredient alone wouldn’t be effective in classifying the other macros. Additionally, ingredients and tags whose proportions are too small will not be present enough for the model to learn from the recipes which contain them. Hence, it’s important to choose the right ingredients. This is also why using Lasso is helpful. Due to it’s shrinkage property, the nessessary ingredeints and tags will be filtered for each of the macros.
Secondly, the <code class="language-plaintext highlighter-rouge">n_ingredients</code> and <code class="language-plaintext highlighter-rouge">n_steps</code> features don’t have a high \(R^2\) value with protein. This means it’s highly likely that their relation to the protein macro isn’t linear. Hence, we can use sklearn’s <em>PolynomialFeatures</em> to determine the right relationship between these numerical features and macros.</p>
<h2 id="final-model">Final Model</h2>
<p>In the final model, we will make use of sklearn’s <strong>GridSearchCV</strong> class. This way, we will <strong>cross validate</strong> while training to reduce overfitting, allowing our training MSE to more closely match our testing MSE. Additionally, we’ll also experiment with different hyperparams such as the punishment coefficient for Lasso and the polynomial features for each of the numerical features. Aside from that, we’ll be adding the top \(20\) most popular tags and ingredients. After the top \(20@\), their proportions get too small to be able to adequetly train the Lasso model and would simply introduce noice. Addtionally, while this approach may not gurantee that soley the best features are being used to train each model, different features may be useful for different macros. One of the goals of this project is interpretability. After creating the model, we are able to interpret the parameters to determine which features were of service to which macros.</p>
<h3 id="results">Results</h3>
<p>The following are the MSE of the test sets.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Macro</th>
      <th style="text-align: right">Test MSE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">calories</td>
      <td style="text-align: right">418557</td>
    </tr>
    <tr>
      <td style="text-align: left">fat</td>
      <td style="text-align: right">2144.63</td>
    </tr>
    <tr>
      <td style="text-align: left">sugar</td>
      <td style="text-align: right">13047.8</td>
    </tr>
    <tr>
      <td style="text-align: left">sodium</td>
      <td style="text-align: right">1.4756700.1</td>
    </tr>
    <tr>
      <td style="text-align: left">protein</td>
      <td style="text-align: right">566.39</td>
    </tr>
    <tr>
      <td style="text-align: left">saturated fat</td>
      <td style="text-align: right">204.198</td>
    </tr>
    <tr>
      <td style="text-align: left">carbohydrates</td>
      <td style="text-align: right">5490.71</td>
    </tr>
  </tbody>
</table>

<p>As can be see, there’s a significant decrease in the MSE for <code class="language-plaintext highlighter-rouge">protein</code> from the baseline model. The training MSEs are also lesser with the protein training MSE being \(405.1\)$.</p>

<p>The following are the optimal hyperparams for each of the models.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left"> </th>
      <th style="text-align: right">calories</th>
      <th style="text-align: right">fat</th>
      <th style="text-align: right">sugar</th>
      <th style="text-align: right">sodium</th>
      <th style="text-align: right">protein</th>
      <th style="text-align: right">saturated fat</th>
      <th style="text-align: right">carbohydrates</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">N_Steps Poly Features</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td style="text-align: left">N_Ingredients Poly Features</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">3</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">1</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td style="text-align: left">Lassor regressor</td>
      <td style="text-align: right">0.0625</td>
      <td style="text-align: right">0.0625</td>
      <td style="text-align: right">0.0625</td>
      <td style="text-align: right">0.5</td>
      <td style="text-align: right">0.0625</td>
      <td style="text-align: right">0.0625</td>
      <td style="text-align: right">0.0625</td>
    </tr>
  </tbody>
</table>

<p>As can be seen, the polynomial features most most of the models are greather than 1, suggesting a non-linear relationship between said macros and the numerical features. The optimal punishment tends to be \(0.0625\) for most of the values. 
<strong>Note</strong> The range of the polynomial features exponent ranges from \(1\) to \(4\) and \(2^{-5}\) to \(2^{4}\) for something the Lasso punishment.</p>
<h4 id="interpreting-the-parameters">Interpreting the Parameters</h4>
<p>Now, we are able to interpret the impact of adding each of the ingredients to the model. The following table is the meat tag coefficient. As expected, it’s positive for <code class="language-plaintext highlighter-rouge">protein</code> and negative for <code class="language-plaintext highlighter-rouge">carbohydrates</code>. Take a look at the <strong>Interesting Aggregates</strong> section to see why.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Macro</th>
      <th style="text-align: right">meat_tag coefficient</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">calories</td>
      <td style="text-align: right">115.549</td>
    </tr>
    <tr>
      <td style="text-align: left">fat</td>
      <td style="text-align: right">9.74835</td>
    </tr>
    <tr>
      <td style="text-align: left">sugar</td>
      <td style="text-align: right">-1.04353</td>
    </tr>
    <tr>
      <td style="text-align: left">sodium</td>
      <td style="text-align: right">251.082</td>
    </tr>
    <tr>
      <td style="text-align: left">protein</td>
      <td style="text-align: right">11.1625</td>
    </tr>
    <tr>
      <td style="text-align: left">saturated fat</td>
      <td style="text-align: right">2.35439</td>
    </tr>
    <tr>
      <td style="text-align: left">carbohydrates</td>
      <td style="text-align: right">-4.08609</td>
    </tr>
  </tbody>
</table>

<p>Now, if we were to specialize towards predicting the values of a certain macro, we can do so by selecting only the columns which provice any significant value.
In the following, the <strong>all_coefficients</strong> dataframe represents the coefficient for each of the macros.<br /><code class="language-plaintext highlighter-rouge">all_coefficients[(all_coefficients['protein'] &gt; 1) | (all_coefficients['protein'] &lt; -1)]['protein']</code><br />
This singles out any important ingredient or tag! We get the following series:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Feature</th>
      <th style="text-align: right">Protein (Grams)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">15-minutes-or-less_tag</td>
      <td style="text-align: right">-3.74627</td>
    </tr>
    <tr>
      <td style="text-align: left">30-minutes-or-less_tag</td>
      <td style="text-align: right">-2.27869</td>
    </tr>
    <tr>
      <td style="text-align: left">60-minutes-or-less_tag</td>
      <td style="text-align: right">-2.51325</td>
    </tr>
    <tr>
      <td style="text-align: left">baking powder_ing</td>
      <td style="text-align: right">-1.00415</td>
    </tr>
    <tr>
      <td style="text-align: left">baking soda_ing</td>
      <td style="text-align: right">-1.69974</td>
    </tr>
    <tr>
      <td style="text-align: left">course_tag</td>
      <td style="text-align: right">-5.9061</td>
    </tr>
    <tr>
      <td style="text-align: left">low-carb_tag</td>
      <td style="text-align: right">4.09764</td>
    </tr>
    <tr>
      <td style="text-align: left">main-dish_tag</td>
      <td style="text-align: right">10.6352</td>
    </tr>
    <tr>
      <td style="text-align: left">meat_tag</td>
      <td style="text-align: right">11.1625</td>
    </tr>
    <tr>
      <td style="text-align: left">n_ingredients</td>
      <td style="text-align: right">1.61722</td>
    </tr>
    <tr>
      <td style="text-align: left">n_steps</td>
      <td style="text-align: right">1.09601</td>
    </tr>
    <tr>
      <td style="text-align: left">sugar_ing</td>
      <td style="text-align: right">-2.62982</td>
    </tr>
    <tr>
      <td style="text-align: left">time-to-make_tag</td>
      <td style="text-align: right">-2.06129</td>
    </tr>
    <tr>
      <td style="text-align: left">vegetables_tag</td>
      <td style="text-align: right">-5.13664</td>
    </tr>
  </tbody>
</table>

<p>Hence, future Macro regressors can focus solely on one macro at a time and aim to increase the training time using only the features whch are of use. Additional research can be done, interpreting the parameters.</p>

<p>Thank you!</p>

        </section>

        <aside id="sidebar">
          

          
            <p class="repo-owner"><a href="https://github.com/AdvaySingh1/Macro-Regressor">Macro-Regressor</a> is maintained by <a href="https://github.com/AdvaySingh1">AdvaySingh1</a>.</p>
          

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</p>
        </aside>
      </div>
    </div>

  </body>
</html>
